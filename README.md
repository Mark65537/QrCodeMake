![image](https://github.com/Mark65537/QrCodeMake/blob/master/screens/main.png)
# Описание 
программа созданна для того что бы создавать множество QR-кодов 
по данным из Excel 
и отправлять их письмом по заранее созданну шаблону(Word) на электронную почту 

# Описание программы

![image](https://github.com/Mark65537/QrCodeMake/blob/master/screens/mainDesc.png)

1. TextBox в котором выводиться расшифровка QR-кода
2. Изображение QR-кода
3. Кнопки для пролистывание изображений QR-кодов вправо и влево
4. TextBox в котором выводиться путь до Excel файла
5. ComboBox для установки ошибки коррекции. По умолчанию Medium
6. Кнопка для копирования текущего изображения QR-кода в буфер обмена
7. Кнопка "о программе"(на данный момент не работает)
8. Кнопка для отправки Email с пригласительным письмом
9. CheckBox означающий кому отправлять письма, всем или текущему пользователю
10. Кнопка которая открывает файловый браузер для открытия Excel файла
11. Кнопка для открытия настроек, где можно посмотреть и настроить заменители(нельзя заменить неизменяемые заменители, так как для безопастности кода они зашиты в программу)<br>
Форма настроек:<br>
![image](https://github.com/Mark65537/QrCodeMake/blob/master/screens/OptionForm.png) ![image](https://github.com/Mark65537/QrCodeMake/blob/master/screens/OptionForm2.png)
# Описание проектов
QrCodeMakelib - проект где собранны основные классы, которые используются в остальных проектах. Для удобства
все классы являются статическими, что бы было просто импортировать в другие проекты<br>
QrCodeMake-Console - консольная версия приложения. Применяется для быстарой обработки через аргументы(на данный момент не работает)<br>
QrCodeMake-WinForm - версия c графическим интерфейсом для удобной работы с QR-кодами.
В отличие от консольной версии, не имеет аргументов при вызове<br>

# Инструкция

1. сначало нужно загрузить файл с данными пользователей в формате excel. Если у вас уже есть этот файл,
то переходите к шагу 2, если нету, то создайте файл excel в формате xlsx по заданным правилам
	1.1 первая строка не учитывается, так как в ей должны содержаться названия столбцов в дальнейшем заголовок
	1.2 В заголовке должны содержаться ключевые слова которые описанны в таблице
		построить html таблицу на 2 столбца и 4 строки где зеголовок первого столбца ключевое слово, заголовок второго возможные значения
		<table> 
		<thead> 
			<tr> 
				<th>Ключевое слово</th> <th>Возможные значения</th> 
			</tr> 
		</thead> 
		<tbody> 
			<tr> 
				<td>мероприятие</td> <td>беруться все столбцы с мероприятиями, пустая строка не учитывается</td> 
			</tr> 
			<tr> 
				<td>форма участия</td> <td>может быть Очная
 				или Дистанционная. Беруться только те строки где есть Дистанционная</td> 
			</tr> 
			<tr> 
				<td>фио</td> <td>Фамилия Имя Отчество участника</td> 
			</tr> 
			<tr> 
				<td>почт</td> <td>Электронная почта. Должна содержать знак @ иначе письмо не отправиться</td> 
			</tr>
		</tbody> 
		</table> 
	1.3 программа считывает файл построчно, до тех пор пока не обнаружиться пустая строка, точнее пустой 1й столбец в этой строке
2. Если вы хотите просто скопировать QR-код, то нажмите на кнопку "Скопировать QR-код" 
и он сразу скопируется в буфер обмена. Если вы хотите отправить выбранный QR-код или все QR-коды по Email,
то переходите к шагу 3
3. Приготовьте шаблон в формате Word(.docx) как будет выглядеть ваше письмо. В шаблоне замените места которые 
будут у вас меняться в зависимости от обстоятельств. Можно заменять любыми словами, но рекомендуется 
использовать Латинские слова, так как он реже встречаеться в обычном тексте, например: Str_dateFull. Исключение 
составляет лишь Неизменяемые заменители, которые вы можете посмотреть в Форме настроек. Все эти замены нам понадобяться 
на следующем шаге
4. Создайте файл с заменителями conf.json(название файла может меняться в зависимости от версии программы, поэтому просто ищите файл в формате json, он должен быть там один) или используйте уже существующий. В него мы будем записывать все что 
заменили на предыдущем шаге. Так же можно воспользоваться формой настроек для более удобного создания и изменения заменителей. Не забудьте нажать кнопку Сохранить, для того что бы изменения сохранились 
5. В файле QrCodeMake.exe.config в теге <userSettings> содержаться настройки для отправки email, а именно
mailFrom- Имя почты с которой будет отравляться письмо
appPass- Пароль приложения, нужен для того что бы письмо отправилось. ВНИМАНИЕ: пароль приложения не является 
паролем от вашей почты. Что бы узнать пароль приложения зайдите в настройки вашей почты.
subject- Тема сообщения. по умолчанию это: "Сообщение сгенерированно с помощью программы QrCodeMake"
provider- Это некий smtp клиент который зависит от почты с которой вы отправляете.
по умолчанию стоит yandex, но вы можете заменить на ваш клиент наример: google или mail.
6. Если все сделанно правильно, то после нажатия на кнопку "Отправить по email" появиться Форма результатов. на ней можно посмотреть кому отправилось сообщение, а кому нет 
![image](https://github.com/Mark65537/QrCodeMake/blob/master/screens/resultForm.png)

# Описание работы программы
Программа поделена на 5 этапов<br>
1. Excel - данные загружаются из Excel и собираются в одну сущьность называемую Person(ExcelClass);
2. Form - данные из Person собранные на шаге 1 передаются на форму, где там же и отображаются, и засчет этого
строится QR-код. После нажатия на кнопку "Отправить по email" начинается шаг 3
3. Word - считывается шаблон из файла Word и преобразуется в html формат для отправки(WordClass)
4. Html - считывается файл конфига(conf.json)(HtmlClass)
5. Email - если существует файл конфига, то с помощью него редактируется файл html созданный на шаге 3, 
и после этого измененный html файл отправляется по почте.

# Используемые технологии
Newtonsoft.Json, Microsoft.Office.Interop.Excel, Microsoft.Office.Interop.Word, QrCodeGenerator, System.Net.Mail